{"type": "code", "content": "```python\nimport pandas as pd\npd.set_option('display.max_rows', None)\ndf = pd.read_csv('listings.csv')\nreservations = df[df['Type'] == 'Reservation']\nreservations['Start Date'] = pd.to_datetime(reservations['Start Date'])\nreservations['Year'] = reservations['Start Date'].dt.year\nreservations['Month'] = reservations['Start Date'].dt.month\nreservations['Nightly Rate'] = (reservations['Amount'] - reservations['Cleaning Fee']) / reservations['Nights']\nall_listings = reservations['Listing'].unique()\nall_years = reservations['Year'].unique()\nall_months = range(1, 13)\nindex = pd.MultiIndex.from_product([all_listings, all_years, all_months], names=['Listing', 'Year', 'Month'])\nall_data = pd.DataFrame(index=index).reset_index()\nmerged_data = pd.merge(all_data, reservations, on=['Listing', 'Year', 'Month'], how='left')\naverage_nightly_rates = merged_data.groupby(['Listing', 'Year', 'Month'])['Nightly Rate'].mean().fillna(0)\nprint(average_nightly_rates)\n```"}